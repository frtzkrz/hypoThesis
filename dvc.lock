schema: '2.0'
stages:
  concatenate:
    cmd: "python scripts/join_and_split.py -i data/2021-usz-oropharynx.csv data/2021-clb-oropharynx.csv\
      \ --type Unilateral -o data\n"
    deps:
    - path: data/2021-clb-oropharynx.csv
      md5: 6255831d997636bf350ffa590666f482
      size: 154699
    - path: data/2021-usz-oropharynx.csv
      md5: b682139514e901a6896235376a2f34fc
      size: 269549
    - path: scripts/join_and_split.py
      md5: d6d8d4a6eef76dd3f38fde5b30880979
      size: 4557
    params:
      params.yaml:
        cross-validation:
          seed: 42
          rounds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
    outs:
    - path: data/joined.csv
      md5: a897ebe023348647dfbcf55f61d506a3
      size: 253833
    - path: data/rounds
      md5: a7f87db7323bac4657baadcd0f4d9e71.dir
      size: 1278485
      nfiles: 10
  sampling:
    cmd: "python -m lyscripts.sample data/cleaned.csv models/samples.hdf5 --plots\
      \ plots/sampling --ti\n"
    deps:
    - path: data/cleaned.csv
      md5: cc7279dc7e86ad23c552651a9433107a
      size: 486853
    params:
      params.yaml:
        graph:
          tumor:
            primary:
            - II
            - III
            - IV
          lnl:
            II:
            - III
            III:
            - IV
            IV: []
        modalities:
          max_llh:
          - 1.0
          - 1.0
        model:
          first_binom_prob: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: MidlineBilateral
          kwargs:
            base_symmetric: false
            trans_symmetric: true
            use_mixing: true
        sampling:
          walkers_per_dim: 20
          burnin: 1000
          nsteps: 50
          thin_by: 5
          temp_schedule:
          - 0.0
          - 1.0076210988534706e-09
          - 3.224387516331105e-08
          - 2.448519270213932e-07
          - 1.031804005225953e-06
          - 3.148815933917096e-06
          - 7.835261664684588e-06
          - 1.6935087808430282e-05
          - 3.3017728167230525e-05
          - 5.949901826619859e-05
          - 0.00010076210988534707
          - 0.0001622783855914503
          - 0.0002507283732699068
          - 0.0003741226606566017
          - 0.000541922809869769
          - 0.0007651622719418543
          - 0.0010565673013513768
          - 0.0014306778705547923
          - 0.001903968584518355
          - 0.00249496959524998
          - 0.0032243875163311063
          - 0.004115226337448558
          - 0.00519290833892641
          - 0.006485395006257844
          - 0.008023307944637018
          - 0.009840049793490924
          - 0.011971925141011254
          - 0.014458261438686257
          - 0.01734152991583261
          - 0.020667466494127266
          - 0.02448519270213934
          - 0.02884733658986194
          - 0.03381015364324406
          - 0.0394336476987224
          - 0.045781691857753354
          - 0.05292214940134466
          - 0.06092699470458736
          - 0.06987243415118778
          - 0.07983902704799936
          - 0.09091180653955425
          - 0.1031804005225954
          - 0.11673915256060852
          - 0.13168724279835387
          - 0.14812880887639787
          - 0.16617306684564512
          - 0.18593443208187052
          - 0.207532640200251
          - 0.231092867969897
          - 0.2567458542283846
          - 0.28462802079628763
          - 0.31488159339170957
          - 0.34765472254481466
          - 0.38310160451236014
          - 0.4213826021922288
          - 0.46266436603796024
          - 0.5071199549732823
          - 0.5549289573066435
          - 0.6062776116457449
          - 0.6613589278120725
          - 0.7203728077554274
          - 0.7835261664684589
          - 0.8510330529011965
          - 0.923114770875582
          - 1.0
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 30.0
            rel_acor_threshold: 0.075
    outs:
    - path: models/samples.hdf5
      md5: 064c3e84720f536372b1a031dd04e550
      size: 174498528
    - path: plots/sampling/accept_rates.csv
      md5: c646e9c0ce7573342966b78e596fd7b1
      size: 2082
    - path: plots/sampling/acor_times.csv
      md5: 7accbcc74216f405f42f14dff485c8c4
      size: 2441
  risk:
    cmd: "python -m lyscripts.risk -m models/samples.hdf5 -d data/cleaned.csv -o plots/risks\n"
    deps:
    - path: data/cleaned.csv
      md5: ed2659e6f454a563fdb1e6768a05c134
      size: 486853
    - path: models/samples.hdf5
      md5: 5724313269ff6ea5e004922ae9b364c2
      size: 228829088
    params:
      params.yaml:
        model:
          first_binom_prob: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: MidlineBilateral
          kwargs:
            base_symmetric: false
            trans_symmetric: true
            use_mixing: false
        risk_plots:
        - title: contra overall
          num_bins: 50
          scenarios:
          - label: early | no midext
            t_stage: early
            invert: true
            pattern:
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: early | with midext
            t_stage: early
            invert: true
            pattern:
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
            comp_modality: max_llh
          - label: late | no midext
            t_stage: late
            invert: true
            pattern:
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: late | with midext
            t_stage: late
            invert: true
            pattern:
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
            comp_modality: max_llh
        - title: contra LNL II
          num_bins: 50
          scenarios:
          - label: early | no midext
            t_stage: early
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: early | with midext
            t_stage: early
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
            comp_modality: max_llh
          - label: late | no midext
            t_stage: late
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: late | with midext
            t_stage: late
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
            comp_modality: max_llh
        - title: contra LNL III
          num_bins: 50
          scenarios:
          - label: early | no midext
            t_stage: early
            invert: false
            pattern:
              contra:
                I:
                II:
                III: true
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: early | with midext
            t_stage: early
            invert: false
            pattern:
              contra:
                I:
                II:
                III: true
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
            comp_modality: max_llh
          - label: late | no midext
            t_stage: late
            invert: false
            pattern:
              contra:
                I:
                II:
                III: true
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: late | with midext
            t_stage: late
            invert: false
            pattern:
              contra:
                I:
                II:
                III: true
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
            comp_modality: max_llh
        - title: contra LNL II given healthy CT
          num_bins: 50
          scenarios:
          - label: early | no midext
            t_stage: early
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis:
              ipsi:
                I: false
                II: false
                III: false
                IV: false
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
          - label: early | with midext
            t_stage: early
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis:
              ipsi:
                I: false
                II: false
                III: false
                IV: false
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
          - label: late | no midext
            t_stage: late
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis:
              ipsi:
                I: false
                II: false
                III: false
                IV: false
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
          - label: late | with midext
            t_stage: late
            invert: false
            pattern:
              contra:
                I:
                II: true
                III:
                IV:
            diagnosis:
              ipsi:
                I: false
                II: false
                III: false
                IV: false
              contra:
                I: false
                II: false
                III: false
                IV: false
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: true
        - title: ipsi by level
          num_bins: 50
          scenarios:
          - label: LNL II | early
            t_stage: early
            invert: false
            pattern:
              ipsi:
                I:
                II: true
                III:
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: LNL III | early
            t_stage: early
            invert: false
            pattern:
              ipsi:
                I:
                II:
                III: true
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: LNL II | late
            t_stage: late
            invert: false
            pattern:
              ipsi:
                I:
                II: true
                III:
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
          - label: LNL III | late
            t_stage: late
            invert: false
            pattern:
              ipsi:
                I:
                II:
                III: true
                IV:
            diagnosis_spsn:
            - 0.76
            - 0.81
            midline_ext: false
            comp_modality: max_llh
        sampling.nsteps: 50
    outs:
    - path: plots/risks
      md5: b82229de7aadb379320e1d4a7cd56ea8.dir
      size: 743423
      nfiles: 10
  full-sampling:
    cmd: "python scripts/sample.py -i data/cleaned.csv -o models/full.hdf5 --acor\
      \ plots/acor/full.csv\n"
    deps:
    - path: data/cleaned.csv
      md5: 509a8bb9ee9ef09e9834b1af95179c36
      size: 250658
    - path: scripts/sample.py
      md5: d2beaf8a708f48adb95234367de2c9ef
      size: 4019
    params:
      params.yaml:
        modalities:
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
        sampling:
          walkers_per_dim: 20
          keep_steps: 500
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 50.0
            rel_acor_threshold: 0.05
    outs:
    - path: models/full.hdf5
      md5: 7bbc6d703cc71652076a4562e38cfc54
      size: 60798728
    - path: plots/acor/full.csv
      md5: 5cc10256495cf80f57e7c7a0a576729f
      size: 845
  test@is:
    cmd: echo "is roman"
  test@my:
    cmd: echo "my name"
  test@hi:
    cmd: echo "hi there"
  test@one:
    cmd: echo "one"
  test@three:
    cmd: echo "three"
  test@two:
    cmd: echo "two"
  cv-sampling@c:
    cmd: "python scripts/sample.py -i data/folds/c_train.csv -o models/folds/c.hdf5\
      \ --acor plots/acor/c.csv\n"
    deps:
    - path: data/folds/c_train.csv
      md5: 9d289fdc3e18fc051bf911781bbb796b
      size: 201050
    - path: scripts/sample.py
      md5: d2beaf8a708f48adb95234367de2c9ef
      size: 4019
    params:
      params.yaml:
        cross-validation:
          seed: 42
          folds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
        modalities:
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
        sampling:
          walkers_per_dim: 20
          keep_steps: 500
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 50.0
            rel_acor_threshold: 0.05
    outs:
    - path: models/folds/c.hdf5
      md5: 41bb848e9d8a7b575c0644681f2798bd
      size: 58642192
    - path: plots/acor/c.csv
      md5: 5a3e1d28a50d5f0b2e53fc663f25b183
      size: 814
  cv-sampling@f:
    cmd: "python scripts/sample.py -i data/folds/f_train.csv -o models/folds/f.hdf5\
      \ --acor plots/acor/f.csv\n"
    deps:
    - path: data/folds/f_train.csv
      md5: 6a0c473f2f9ac2f33c8d1805fc318bb6
      size: 200960
    - path: scripts/sample.py
      md5: d2beaf8a708f48adb95234367de2c9ef
      size: 4019
    params:
      params.yaml:
        cross-validation:
          seed: 42
          folds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
        modalities:
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
        sampling:
          walkers_per_dim: 20
          keep_steps: 500
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 50.0
            rel_acor_threshold: 0.05
    outs:
    - path: models/folds/f.hdf5
      md5: c974d30271c8d2e10302a23772779599
      size: 51499440
    - path: plots/acor/f.csv
      md5: daaa4c234c5e246214c1de46db3c2508
      size: 713
  cv-sampling@d:
    cmd: "python scripts/sample.py -i data/folds/d_train.csv -o models/folds/d.hdf5\
      \ --acor plots/acor/d.csv\n"
    deps:
    - path: data/folds/d_train.csv
      md5: 9635e113359a7d1a9b06c2bc9126db7d
      size: 200968
    - path: scripts/sample.py
      md5: d2beaf8a708f48adb95234367de2c9ef
      size: 4019
    params:
      params.yaml:
        cross-validation:
          seed: 42
          folds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
        modalities:
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
        sampling:
          walkers_per_dim: 20
          keep_steps: 500
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 50.0
            rel_acor_threshold: 0.05
    outs:
    - path: models/folds/d.hdf5
      md5: 04aad7b962911c437d25b3b5a824b4b8
      size: 60798728
    - path: plots/acor/d.csv
      md5: 3de09a5f7dc81ab2ae33e29b2f1f7cf8
      size: 840
  cv-sampling@b:
    cmd: "python scripts/sample.py -i data/folds/b_train.csv -o models/folds/b.hdf5\
      \ --acor plots/acor/b.csv\n"
    deps:
    - path: data/folds/b_train.csv
      md5: cea3235de9253c5b682fbbc724e756ed
      size: 201036
    - path: scripts/sample.py
      md5: d2beaf8a708f48adb95234367de2c9ef
      size: 4019
    params:
      params.yaml:
        cross-validation:
          seed: 42
          folds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
        modalities:
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
        sampling:
          walkers_per_dim: 20
          keep_steps: 500
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 50.0
            rel_acor_threshold: 0.05
    outs:
    - path: models/folds/b.hdf5
      md5: f66d5ab2249ab4049345e231238926ca
      size: 60798728
    - path: plots/acor/b.csv
      md5: dd687efaf892d09cdf22368ba7d05b64
      size: 840
  cv-sampling@a:
    cmd: "python scripts/sample.py -i data/folds/a_train.csv -o models/folds/a.hdf5\
      \ --acor plots/acor/a.csv\n"
    deps:
    - path: data/folds/a_train.csv
      md5: 43e52da7ac868dfc216b3197a24917d2
      size: 200459
    - path: scripts/sample.py
      md5: d2beaf8a708f48adb95234367de2c9ef
      size: 4019
    params:
      params.yaml:
        cross-validation:
          seed: 42
          folds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
        modalities:
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
        sampling:
          walkers_per_dim: 20
          keep_steps: 500
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 50.0
            rel_acor_threshold: 0.05
    outs:
    - path: models/folds/a.hdf5
      md5: 9e9da19cff804b79dcd0b8d39ca64e75
      size: 65108664
    - path: plots/acor/a.csv
      md5: 00d77f2bb04331b8d24af76450118c1e
      size: 888
  mermaid:
    cmd: dvc dag --full --mermaid --md >> dag.md
    outs:
    - path: dag.md
      md5: 05240a739a38bbbab99930ded523e34f
      size: 659
  join:
    cmd: "python -m lyscripts join --inputs data/2021-usz-oropharynx.csv data/2021-clb-oropharynx.csv\
      \ --output data/joined.csv\n"
    deps:
    - path: data/2021-clb-oropharynx.csv
      md5: d40c0a1ae967a6983d60a0a809cf3972
      size: 92742
    - path: data/2021-usz-oropharynx.csv
      md5: 4c62057de32538d2274eaf7f2af0c759
      size: 159482
    outs:
    - path: data/joined.csv
      md5: 7992f871b1be0f226a516418a7531892
      size: 307977
  split:
    cmd: "python scripts/split.py -i data/cleaned.csv -o data/folds\n"
    deps:
    - path: data/cleaned.csv
      md5: 509a8bb9ee9ef09e9834b1af95179c36
      size: 250658
    - path: scripts/split.py
      md5: b6239b988e6f8ce33178dd495091265a
      size: 2844
    params:
      params.yaml:
        cross-validation:
          seed: 42
          folds:
            a:
            - e
            - t
            - t
            - t
            - t
            b:
            - t
            - e
            - t
            - t
            - t
            c:
            - t
            - t
            - e
            - t
            - t
            d:
            - t
            - t
            - t
            - e
            - t
            f:
            - t
            - t
            - t
            - t
            - e
        model:
          graph:
            tumor:
              primary:
              - I
              - II
              - III
              - IV
            lnl:
              I:
              - II
              II:
              - III
              III:
              - IV
              IV: []
          early_p: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: Unilateral
    outs:
    - path: data/folds
      md5: 4ba38bc054496162daf002837738e96e.dir
      size: 1262495
      nfiles: 10
  clean:
    cmd: python -m lyscripts clean data/enhanced.csv data/cleaned.csv
    deps:
    - path: data/enhanced.csv
      md5: 96bda628740be02933997b5edbe1588d
      size: 375364
    params:
      params.yaml:
        model.class: MidlineBilateral
    outs:
    - path: data/cleaned.csv
      md5: 108bfd0bcf0f98e1cb9757689d250038
      size: 300071
  evaluate:
    cmd: "python -m lyscripts evaluate data/cleaned.csv models/samples.hdf5 --metrics\
      \ metrics.json --plots plots/ti/accuracies.csv\n"
    deps:
    - path: data/cleaned.csv
      md5: cc7279dc7e86ad23c552651a9433107a
      size: 486853
    - path: models/samples.hdf5
      md5: 064c3e84720f536372b1a031dd04e550
      size: 174498528
    params:
      params.yaml:
        graph:
          tumor:
            primary:
            - II
            - III
            - IV
          lnl:
            II:
            - III
            III:
            - IV
            IV: []
        modalities:
          max_llh:
          - 1.0
          - 1.0
        model:
          first_binom_prob: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: MidlineBilateral
          kwargs:
            base_symmetric: false
            trans_symmetric: true
            use_mixing: true
        sampling:
          walkers_per_dim: 20
          burnin: 1000
          nsteps: 50
          thin_by: 5
          temp_schedule:
          - 0.0
          - 1.0076210988534706e-09
          - 3.224387516331105e-08
          - 2.448519270213932e-07
          - 1.031804005225953e-06
          - 3.148815933917096e-06
          - 7.835261664684588e-06
          - 1.6935087808430282e-05
          - 3.3017728167230525e-05
          - 5.949901826619859e-05
          - 0.00010076210988534707
          - 0.0001622783855914503
          - 0.0002507283732699068
          - 0.0003741226606566017
          - 0.000541922809869769
          - 0.0007651622719418543
          - 0.0010565673013513768
          - 0.0014306778705547923
          - 0.001903968584518355
          - 0.00249496959524998
          - 0.0032243875163311063
          - 0.004115226337448558
          - 0.00519290833892641
          - 0.006485395006257844
          - 0.008023307944637018
          - 0.009840049793490924
          - 0.011971925141011254
          - 0.014458261438686257
          - 0.01734152991583261
          - 0.020667466494127266
          - 0.02448519270213934
          - 0.02884733658986194
          - 0.03381015364324406
          - 0.0394336476987224
          - 0.045781691857753354
          - 0.05292214940134466
          - 0.06092699470458736
          - 0.06987243415118778
          - 0.07983902704799936
          - 0.09091180653955425
          - 0.1031804005225954
          - 0.11673915256060852
          - 0.13168724279835387
          - 0.14812880887639787
          - 0.16617306684564512
          - 0.18593443208187052
          - 0.207532640200251
          - 0.231092867969897
          - 0.2567458542283846
          - 0.28462802079628763
          - 0.31488159339170957
          - 0.34765472254481466
          - 0.38310160451236014
          - 0.4213826021922288
          - 0.46266436603796024
          - 0.5071199549732823
          - 0.5549289573066435
          - 0.6062776116457449
          - 0.6613589278120725
          - 0.7203728077554274
          - 0.7835261664684589
          - 0.8510330529011965
          - 0.923114770875582
          - 1.0
          kwargs:
            max_steps: 10000
            check_interval: 100
            trust_threshold: 30.0
            rel_acor_threshold: 0.075
    outs:
    - path: metrics.json
      md5: d4e29a7a5509135091753e6184ac97ce
      size: 160
    - path: plots/ti/accuracies.csv
      md5: f5613401b7d3a9d77c5029e31e227768
      size: 3734
  full-evaluate:
    cmd: "python scripts/evaluate.py --model models/full.hdf5 --metric metrics/full.json\n"
    deps:
    - path: models/full.hdf5
      md5: 7bbc6d703cc71652076a4562e38cfc54
      size: 60798728
    - path: scripts/evaluate.py
      md5: 1b74f31467da83cf4b59f19716ab5010
      size: 4607
    outs:
    - path: metrics/full.json
      md5: 062c9df67418985fed85445bed4f757f
      size: 120
  cv-evaluate@b:
    cmd: "python scripts/evaluate.py --model models/folds/b.hdf5 --data data/folds/b_eval.csv\
      \ --metrics metrics/b.json\n"
    deps:
    - path: data/folds/b_eval.csv
      md5: f6e3d48ee33b1a3ef6f332549b85a7c7
      size: 51463
    - path: models/folds/b.hdf5
      md5: f66d5ab2249ab4049345e231238926ca
      size: 60798728
    - path: scripts/evaluate.py
      md5: 1b74f31467da83cf4b59f19716ab5010
      size: 4607
    outs:
    - path: metrics/b.json
      md5: b2c74d3475ff98fe2f39b8b9810e320e
      size: 162
  cv-evaluate@f:
    cmd: "python scripts/evaluate.py --model models/folds/f.hdf5 --data data/folds/f_eval.csv\
      \ --metrics metrics/f.json\n"
    deps:
    - path: data/folds/f_eval.csv
      md5: 1adb76678bcfe61a855dcca67551e482
      size: 51539
    - path: models/folds/f.hdf5
      md5: c974d30271c8d2e10302a23772779599
      size: 51499440
    - path: scripts/evaluate.py
      md5: 1b74f31467da83cf4b59f19716ab5010
      size: 4607
    outs:
    - path: metrics/f.json
      md5: 6d688423c782703612704f13ecf540cf
      size: 162
  cv-evaluate@a:
    cmd: "python scripts/evaluate.py --model models/folds/a.hdf5 --data data/folds/a_eval.csv\
      \ --metrics metrics/a.json\n"
    deps:
    - path: data/folds/a_eval.csv
      md5: 8dd96d46f461f7dc14c585ae573330d1
      size: 52040
    - path: models/folds/a.hdf5
      md5: 9e9da19cff804b79dcd0b8d39ca64e75
      size: 65108664
    - path: scripts/evaluate.py
      md5: 1b74f31467da83cf4b59f19716ab5010
      size: 4607
    outs:
    - path: metrics/a.json
      md5: 95383f4353bb8bf2fd02cea7bd3a2c8b
      size: 165
  cv-evaluate@c:
    cmd: "python scripts/evaluate.py --model models/folds/c.hdf5 --data data/folds/c_eval.csv\
      \ --metrics metrics/c.json\n"
    deps:
    - path: data/folds/c_eval.csv
      md5: 5ba21fbfd13a1aae7fe5b54ad142945e
      size: 51449
    - path: models/folds/c.hdf5
      md5: 41bb848e9d8a7b575c0644681f2798bd
      size: 58642192
    - path: scripts/evaluate.py
      md5: 1b74f31467da83cf4b59f19716ab5010
      size: 4607
    outs:
    - path: metrics/c.json
      md5: 42548af99ce7dc2df89a040748025629
      size: 151
  cv-evaluate@d:
    cmd: "python scripts/evaluate.py --model models/folds/d.hdf5 --data data/folds/d_eval.csv\
      \ --metrics metrics/d.json\n"
    deps:
    - path: data/folds/d_eval.csv
      md5: 0d75591ed522ed4851d57237066904c2
      size: 51531
    - path: models/folds/d.hdf5
      md5: 04aad7b962911c437d25b3b5a824b4b8
      size: 60798728
    - path: scripts/evaluate.py
      md5: 1b74f31467da83cf4b59f19716ab5010
      size: 4607
    outs:
    - path: metrics/d.json
      md5: a4fa6f11faf4582a0d73d1cda50794db
      size: 166
  plot-corner:
    cmd: "python -m lyscripts plot corner models/samples.hdf5 plots/corner.png\n"
    deps:
    - path: models/samples.hdf5
      md5: 064c3e84720f536372b1a031dd04e550
      size: 174498528
    outs:
    - path: plots/corner.png
      md5: 3da94fa5af796040e2da5dc856150b02
      size: 5386879
  requirements:
    cmd: pip freeze > frozen.txt
    outs:
    - path: frozen.txt
      md5: 7f7f848acdc91c99e6c3297e7134e57c
      size: 2152
  predict:
    cmd: "python -m lyscripts.predict --model models/samples.hdf5 --data data/cleaned.csv\
      \ --output-risks models/risks.hdf5 --output-prevalences models/prevalences.hdf5\n"
    deps:
    - path: data/cleaned.csv
      md5: ed2659e6f454a563fdb1e6768a05c134
      size: 486853
    - path: models/samples.hdf5
      md5: 5724313269ff6ea5e004922ae9b364c2
      size: 228829088
    params:
      params.yaml:
        graph:
          tumor:
            primary:
            - II
            - III
            - IV
          lnl:
            II:
            - III
            III:
            - IV
            IV: []
        model:
          first_binom_prob: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: MidlineBilateral
          kwargs:
            base_symmetric: false
            trans_symmetric: true
            use_mixing: false
        prevalences:
        - name: COA1
          pattern:
            contra:
              I: false
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          midline_ext: false
          invert: true
        - name: COA2
          pattern:
            contra:
              I: false
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          midline_ext: true
          invert: true
        - name: COA3
          pattern:
            contra:
              I: false
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          midline_ext: false
          invert: true
        - name: COA4
          pattern:
            contra:
              I: false
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          midline_ext: true
          invert: true
        risks:
        - name: IIgvnCT1
          involvement:
            contra:
              I:
              II: true
              III:
              IV:
          given_diagnosis:
            ipsi:
              I: false
              II: false
              III: false
              IV: false
            contra:
              I: false
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: false
          invert: false
        - name: IIgvnCT2
          involvement:
            contra:
              I:
              II: true
              III:
              IV:
          given_diagnosis:
            ipsi:
              I: false
              II: false
              III: false
              IV: false
            contra:
              I: false
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: true
          invert: false
        - name: IIgvnCT3
          involvement:
            contra:
              I:
              II: true
              III:
              IV:
          given_diagnosis:
            ipsi:
              I: false
              II: false
              III: false
              IV: false
            contra:
              I: false
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: false
          invert: false
        - name: IIgvnCT4
          involvement:
            contra:
              I:
              II: true
              III:
              IV:
          given_diagnosis:
            ipsi:
              I: false
              II: false
              III: false
              IV: false
            contra:
              I: false
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: true
          invert: false
    outs:
    - path: models/prevalences.hdf5
      md5: 152041bf72296d754ae8189cd8541d70
      size: 392192
    - path: models/risks.hdf5
      md5: 7eeb8754b9d333ed2e6c46d5cb12a9ec
      size: 392192
  plot-risks:
    cmd: "python -m lyscripts.plot.histograms --input models/risks.hdf5 --title \"\
      contra II, given healthy CT\" --names IIgvnCT1 IIgvnCT2 IIgvnCT3 IIgvnCT4 --bins\
      \ 100 --plots plots/risks\n"
    deps:
    - path: models/risks.hdf5
      md5: 9139f616a4a50b85defc8557d965bc47
      size: 328192
    outs:
    - path: plots/risks
      md5: 9f479d023d61ea6b7f8153fd79adb153.dir
      size: 108249
      nfiles: 2
  plot-prevalences:
    cmd: "python -m lyscripts.plot.histograms --input models/prevalences.hdf5 --title\
      \ \"contra overall\" --names COA1 COA2 COA3 COA4 --bins 100 --plots plots/prevalences\n"
    deps:
    - path: models/prevalences.hdf5
      md5: c391099a268264553a46632565918862
      size: 328432
    outs:
    - path: plots/prevalences
      md5: 96669f7b5bd9c1f677c2c9f0a582f1b0.dir
      size: 142661
      nfiles: 2
  predict-prevalences:
    cmd: "python -m lyscripts predict prevalences models/samples.hdf5 data/cleaned.csv\
      \ models/prevalences.hdf5\n"
    deps:
    - path: data/cleaned.csv
      md5: cc7279dc7e86ad23c552651a9433107a
      size: 486853
    - path: models/samples.hdf5
      md5: 064c3e84720f536372b1a031dd04e550
      size: 174498528
    params:
      params.yaml:
        graph:
          tumor:
            primary:
            - II
            - III
            - IV
          lnl:
            II:
            - III
            III:
            - IV
            IV: []
        model:
          first_binom_prob: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: MidlineBilateral
          kwargs:
            base_symmetric: false
            trans_symmetric: true
            use_mixing: true
        prevalences:
        - name: contra/early/noext
          pattern:
            contra:
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          midline_ext: false
          invert: true
        - name: contra/early/ext
          pattern:
            contra:
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          midline_ext: true
          invert: true
        - name: contra/late/noext
          pattern:
            contra:
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          midline_ext: false
          invert: true
        - name: contra/late/ext
          pattern:
            contra:
              II: false
              III: false
              IV: false
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          midline_ext: true
          invert: true
        - name: ipsiII/early
          label: LNL II
          pattern:
            ipsi:
              II: true
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          invert: false
        - name: ipsiIII/early
          label: LNL III
          pattern:
            ipsi:
              III: true
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          invert: false
        - name: ipsiIV/early
          label: LNL IV
          pattern:
            ipsi:
              IV: true
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: early
          invert: false
        - name: ipsiII/late
          label: LNL II
          pattern:
            ipsi:
              II: true
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          invert: false
        - name: ipsiIII/late
          label: LNL III
          pattern:
            ipsi:
              III: true
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          invert: false
        - name: ipsiIV/late
          label: LNL IV
          pattern:
            ipsi:
              IV: true
          modality: max_llh
          modality_spsn:
          - 1.0
          - 1.0
          t_stage: late
          invert: false
    outs:
    - path: models/prevalences.hdf5
      md5: 3efe519cabc63297324d075215595c1f
      size: 819848
  predict-risks:
    cmd: "python -m lyscripts predict risks models/samples.hdf5 models/risks.hdf5\n"
    deps:
    - path: models/samples.hdf5
      md5: 064c3e84720f536372b1a031dd04e550
      size: 174498528
    params:
      params.yaml:
        graph:
          tumor:
            primary:
            - II
            - III
            - IV
          lnl:
            II:
            - III
            III:
            - IV
            IV: []
        model:
          first_binom_prob: 0.3
          max_t: 10
          t_stages:
          - early
          - late
          class: MidlineBilateral
          kwargs:
            base_symmetric: false
            trans_symmetric: true
            use_mixing: true
        risks:
        - name: contra-II/healthyCT/early/noext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: false
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: false
          invert: false
        - name: contra-II/healthyCT/early/ext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: false
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: true
          invert: false
        - name: contra-II/healthyCT/late/noext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: false
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: false
          invert: false
        - name: contra-II/healthyCT/late/ext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: false
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: true
          invert: false
        - name: contra-II/ipsi-II-pos/early/noext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: true
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: false
          invert: false
        - name: contra-II/ipsi-II-pos/early/ext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: true
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: true
          invert: false
        - name: contra-II/ipsi-II-pos/late/noext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: true
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: false
          invert: false
        - name: contra-II/ipsi-II-pos/late/ext
          involvement:
            contra:
              II: true
          given_diagnosis:
            ipsi:
              II: true
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: true
          invert: false
        - name: ipsi-IV/all-neg/early/ext
          label: healthy CT
          involvement:
            ipsi:
              IV: true
          given_diagnosis:
            ipsi:
              II: false
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: true
          invert: false
        - name: ipsi-IV/ipsi-II-pos/early/ext
          label: ipsi II suspicious
          involvement:
            ipsi:
              IV: true
          given_diagnosis:
            ipsi:
              II: true
              III: false
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: early
          midline_ext: true
          invert: false
        - name: ipsi-IV/ipsi-II-III-pos/late/noext
          label: ipsi II & III suspicious
          involvement:
            ipsi:
              IV: true
          given_diagnosis:
            ipsi:
              II: true
              III: true
              IV: false
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: false
          invert: false
        - name: ipsi-IV/ipsi-all-pos/late/ext
          label: all ipsi LNLs suspicious
          involvement:
            ipsi:
              IV: true
          given_diagnosis:
            ipsi:
              II: true
              III: true
              IV: true
            contra:
              II: false
              III: false
              IV: false
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: true
          invert: false
        - name: ipsi-IV/all-pos/late/ext
          label: ipsi & contra all LNLs suspicious
          involvement:
            ipsi:
              IV: true
          given_diagnosis:
            ipsi:
              II: true
              III: true
              IV: true
            contra:
              II: true
              III: true
              IV: true
          given_diagnosis_spsn:
          - 0.76
          - 0.81
          t_stage: late
          midline_ext: true
          invert: false
    outs:
    - path: models/risks.hdf5
      md5: aa71ec6424dba87b3d727cf585bac1b1
      size: 1071800
  plot-prevalences-ipsi:
    cmd: "python -m lyscripts.plot.histograms --input models/prevalences.hdf5 --title\
      \ \"ipsi by LNL\" --names iLNL-IIe iLNL-IIIe iLNL-IVe iLNL-IIl iLNL-IIIl iLNL-IVl\
      \ --bins 100 --plots plots/prevalences\n"
    deps:
    - path: models/prevalences.hdf5
      md5: 4c6fc550203ce5738ceb8fe3f04b4460
      size: 814336
    outs:
    - path: plots/prevalences/ipsi by LNL.png
      md5: 5125dd833c22f938f4c2475c155b06bc
      size: 79171
  plot-prevalences-contra:
    cmd: "python -m lyscripts.plot.histograms --input models/prevalences.hdf5 --title\
      \ \"contra overall\" --names COA1 COA2 COA3 COA4 --bins 100 --plots plots/prevalences\n"
    deps:
    - path: models/prevalences.hdf5
      md5: 426c397d7450864ac575296dd95e194e
      size: 814336
    outs:
    - path: plots/prevalences/contra overall.png
      md5: 95efd2991ff967b735fff08b487739a3
      size: 63776
  plot-prevalences-ipsi-late:
    cmd: "python -m lyscripts.plot.histograms --input models/prevalences.hdf5 --title\
      \ \"ipsi by LNL late\" --names iLNL-IIl iLNL-IIIl iLNL-IVl --bins 100 --plots\
      \ plots/prevalences\n"
    deps:
    - path: models/prevalences.hdf5
      md5: 426c397d7450864ac575296dd95e194e
      size: 814336
    outs:
    - path: plots/prevalences/ipsi by LNL late.png
      md5: f7b74403a87fec460a9fc27e2734d628
      size: 51102
  plot-prevalences-ipsi-early:
    cmd: "python -m lyscripts.plot.histograms --input models/prevalences.hdf5 --title\
      \ \"ipsi by LNL early\" --names iLNL-IIe iLNL-IIIe iLNL-IVe --bins 100 --plots\
      \ plots/prevalences\n"
    deps:
    - path: models/prevalences.hdf5
      md5: 426c397d7450864ac575296dd95e194e
      size: 814336
    outs:
    - path: plots/prevalences/ipsi by LNL early.png
      md5: b252cc01f0f523fb5d986bbdd226ca28
      size: 57344
  mermaid-md:
    cmd: "dvc dag pipeline/dvc.yaml --full --mermaid --md | sed 's/pipeline\\/dvc.yaml://'\
      \ >> dag.md\n"
    outs:
    - path: dag.md
      md5: 7123bd4b2ad25d81b5aec85e01808e3d
      size: 448
  mermaid-png:
    cmd: ./node_modules/.bin/mmdc -i dag.md -o dag.png && mv dag-1.png dag.png
    deps:
    - path: dag.md
      md5: 7123bd4b2ad25d81b5aec85e01808e3d
      size: 448
    outs:
    - path: dag.png
      md5: 1a6fa55acf462f16f4b12124c9488c69
      size: 36101
  enhance:
    cmd: "python -m lyscripts enhance data/joined.csv data/enhanced.csv --modalities\
      \ 'CT' 'MRI' 'PET' 'FNA' 'diagnostic_consensus' 'pathology' 'pCT'\n"
    deps:
    - path: data/joined.csv
      md5: 7992f871b1be0f226a516418a7531892
      size: 307977
    params:
      params.yaml:
        modalities:
          CT:
          - 0.76
          - 0.81
          MRI:
          - 0.63
          - 0.81
          PET:
          - 0.86
          - 0.79
          FNA:
          - 0.98
          - 0.8
          diagnostic_consensus:
          - 0.86
          - 0.81
          pathology:
          - 1.0
          - 1.0
          pCT:
          - 0.86
          - 0.81
          max_llh:
          - 1.0
          - 1.0
    outs:
    - path: data/enhanced.csv
      md5: 4af47ba71b7f9090a66bcf80eff85dfa
      size: 375364
  pipeline:
    cmd: dvc repro pipeline/dvc.yaml
